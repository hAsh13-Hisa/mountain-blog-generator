# WordPress 予約投稿トラブルシューティングガイド

## 🔍 問題の診断

### 1. タイムゾーン設定確認
```
WordPress管理画面 → 設定 → 一般 → タイムゾーン
推奨設定: "東京" または "UTC+9"
```

### 2. WP-Cron動作確認
WordPressの予約投稿はWP-Cronに依存しています。

#### WP-Cronステータス確認方法:
1. **プラグインでの確認**
   - "WP Crontrol" プラグインをインストール
   - ツール → Cron Events で確認

2. **手動確認**
   ```bash
   curl https://teizan.abg.ooo/wp-cron.php
   ```

### 3. サーバー設定確認

#### .htaccess 確認
```apache
# WP-Cronを無効化していないか確認
# 以下の記述があると予約投稿が動作しません
# define('DISABLE_WP_CRON', true);
```

#### wp-config.php 確認
```php
// 以下の設定がある場合はコメントアウト
// define('DISABLE_WP_CRON', true);

// タイムゾーン設定（推奨）
date_default_timezone_set('Asia/Tokyo');
```

## 🔧 予約投稿の修正手順

### 手順1: インポート前確認
1. Featured Image from URL プラグインが有効化されていること
2. WordPressインポーターがインストールされていること
3. 'aime' ユーザーが存在し、投稿権限があること

### 手順2: XMLインポート
1. WordPress管理画面 → ツール → インポート → WordPress
2. 生成されたXMLファイルを選択
3. 投稿者の割り当て: "aime" を選択
4. "添付ファイルをダウンロードしてインポートする" にチェック
5. 実行

### 手順3: インポート後確認
1. 投稿一覧で記事が表示されることを確認
2. ステータスが "予約投稿" になっていることを確認
3. アイキャッチ画像が設定されていることを確認

### 手順4: 予約投稿テスト
1. テスト記事を手動で予約投稿作成
2. 短時間（5-10分後）で設定
3. 自動投稿されるかを確認

## 🚨 よくある問題と解決法

### 問題1: 予約投稿されない
**原因**: WP-Cronが動作していない
**解決法**: 
- WP Crontrolプラグインで手動実行
- サーバー設定でcronジョブを設定

### 問題2: アイキャッチ画像が表示されない
**原因**: プラグイン設定が不正
**解決法**:
```
設定 → Featured Image from URL で以下を確認:
☑ Auto Set Featured Image
☑ Enable URL field on post editing  
☑ Replace featured image
```

### 問題3: 投稿者が変更される
**原因**: ユーザー権限の問題
**解決法**:
- 'aime' ユーザーの権限を確認
- 必要に応じて管理者権限を付与

### 問題4: タイムゾーンがずれる
**原因**: サーバーとWordPressのタイムゾーン不一致
**解決法**:
- WordPress設定でタイムゾーンを "東京" に設定
- wp-config.php でタイムゾーンを設定

## 📋 最終チェックリスト

インポート前:
- [ ] WordPressインポーターインストール済み
- [ ] Featured Image from URL プラグイン有効化済み
- [ ] タイムゾーン設定 = 東京
- [ ] 'aime' ユーザー存在確認
- [ ] WP-Cron動作確認

インポート後:
- [ ] 記事が投稿一覧に表示される
- [ ] ステータスが "予約投稿" になっている
- [ ] アイキャッチ画像が設定されている
- [ ] 投稿者が 'aime' になっている
- [ ] 予約投稿時刻が正しく設定されている

## 🆘 それでも解決しない場合

1. **手動で予約投稿テスト**
   - 新規投稿で手動作成
   - 5分後に予約投稿設定
   - 自動投稿されるかチェック

2. **プラグインの一時無効化**
   - 他のプラグインが干渉していないか確認
   - キャッシュプラグインを一時無効化

3. **サーバーログ確認**
   - エラーログでWP-Cron関連のエラーを確認
   - PHPエラーログを確認

4. **代替手段**
   - 手動での投稿
   - 他の予約投稿プラグインの使用
   - サーバーレベルでのcronジョブ設定
